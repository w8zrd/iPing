import{u as P,c as I,r,j as e,L as _,s as m,l as p}from"./index-Wo41H5bh.js";import{N as A}from"./Navigation-DuyA-6As.js";import{A as F}from"./arrow-left-CX4fna4Q.js";import{c as q}from"./createLucideIcon-foOATjnS.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),B=()=>{var C;const i=P(),{user:n,loading:c}=I(),[d,k]=r.useState(null),[f,h]=r.useState(""),[o,x]=r.useState(""),[t,g]=r.useState(""),[b,v]=r.useState(""),[y,j]=r.useState(""),[N,w]=r.useState(!1),[E,S]=r.useState("");r.useEffect(()=>{if(c||!n){i("/auth");return}(async()=>{const{data:s,error:l}=await m.from("profiles").select("id, username, display_name, bio, location, avatar_url").eq("id",n.id).single();if(l||!s){p.error("Error fetching profile",l,{userMessage:"Failed to load profile data.",showToast:!0});return}k(s),h(s.bio||""),x(s.display_name||""),g(s.username||""),v(s.location||""),j(s.avatar_url||""),S(s.username||"")})()},[n,c,i]);const L=a=>{var l;const s=(l=a.target.files)==null?void 0:l[0];if(s){const u=new FileReader;u.onloadend=()=>{j(u.result)},u.readAsDataURL(s)}},U=async()=>{if(!n||!d)return;w(!0);const{error:a}=await m.from("profiles").update({display_name:o,bio:f,username:t,location:b}).eq("id",d.id);if(w(!1),a)p.error("Error saving settings",a,{userMessage:`Failed to save changes: ${a.message}`,showToast:!0});else if(E!==t){const{error:s}=await m.auth.updateUser({data:{username:t,display_name:o}});s?p.error("Failed to update auth user metadata",s):S(t)}};return c||!d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(_,{})}):e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-8 animate-fade-in flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i(-1),className:"p-2 rounded-full transition-colors text-muted-foreground hover:bg-background/80",children:e.jsx(F,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),e.jsx("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg animate-scale-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsxs("label",{className:"relative cursor-pointer group w-24 h-24",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:"hidden"}),e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white text-3xl font-bold flex items-center justify-center ring-4 ring-primary/20 shadow-lg",children:[((C=o[0])==null?void 0:C.toUpperCase())||"U",y&&e.jsx("img",{src:y,alt:"Profile",className:"w-full h-full object-cover rounded-full"})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(D,{className:"h-6 w-6 text-white"})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Username"}),e.jsx("input",{type:"text",value:t,onChange:a=>g(a.target.value),placeholder:"Enter your username",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Display Name"}),e.jsx("input",{type:"text",value:o,onChange:a=>x(a.target.value),placeholder:"Enter your display name",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bio"}),e.jsx("textarea",{value:f,onChange:a=>h(a.target.value),placeholder:"Tell us about yourself",className:"min-h-[100px] rounded-2xl glass border-border/50 resize-none focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx("input",{type:"text",value:b,onChange:a=>v(a.target.value),placeholder:"Enter your location",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsx("button",{onClick:U,disabled:N,className:"w-full h-12 rounded-2xl bg-primary hover:bg-primary/90 font-semibold transition-apple disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Saving...":"Save Changes"})]})})]}),e.jsx(A,{})]})};export{B as default};
