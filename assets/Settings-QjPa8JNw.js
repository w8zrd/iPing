import{r as a,j as e,e as p,a as _,u as R,s as z,S as n}from"./index-D5B3vO8Q.js";import{N as k}from"./Navigation-_NdfecaC.js";import{B as S}from"./Button-rs4NsoCb.js";import{I as g}from"./Input-DdRv54Oq.js";import{T as B}from"./Textarea-CwRjhZ9X.js";import{X as O}from"./x-DFM2k5ZH.js";import{A as F,b as H,a as q}from"./Avatar-Cl00YIVg.js";import{u as M}from"./use-toast-BZ8SEqu7.js";import{a as V}from"./user-q0TAQv24.js";import{A as X}from"./arrow-left-CbUCReXG.js";import{c as Y}from"./createLucideIcon-BsuKKDQx.js";const $=Y("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),h=a.createContext({open:!1,setOpen:()=>{}}),G=({children:t})=>{const[r,l]=a.useState(!1);return e.jsx(h.Provider,{value:{open:r,setOpen:l},children:t})},D=a.forwardRef(({asChild:t,className:r,...l},c)=>{const{setOpen:i}=a.useContext(h),o=t?"span":"button";return e.jsx(o,{ref:c,className:p("cursor-pointer",r),onClick:()=>i(!0),...l})});D.displayName="DialogTrigger";const P=a.forwardRef(({className:t,children:r,...l},c)=>{const{open:i,setOpen:o}=a.useContext(h);return i?e.jsx("div",{className:"fixed inset-0 z-50 overflow-hidden bg-black/50 backdrop-blur-sm",onClick:()=>o(!1),children:e.jsxs("div",{ref:c,className:p("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 sm:rounded-lg",t),onClick:d=>d.stopPropagation(),...l,children:[r,e.jsxs("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",onClick:()=>o(!1),children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})}):null});P.displayName="DialogContent";const E=({className:t,...r})=>e.jsx("div",{className:p("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});E.displayName="DialogHeader";const A=a.forwardRef(({className:t,...r},l)=>e.jsx("h2",{ref:l,className:p("text-lg font-semibold leading-none tracking-tight",t),...r}));A.displayName="DialogTitle";const oe=()=>{const t=_(),{user:r}=R(),[l,c]=a.useState(null),[i,o]=a.useState(""),[d,b]=a.useState(""),[v,j]=a.useState(""),[N,y]=a.useState(""),[I,w]=a.useState(""),[C,x]=a.useState(!1),{toast:m}=M();a.useEffect(()=>{T()},[r]);const T=async()=>{if(!r)return;x(!0);const{data:s,error:u}=await z.from("profiles").select("username, display_name, bio, verified, location, avatar_url").eq("id",r.id).single();if(!u&&s){const f={...s,display_name:s.display_name};c(f),o(s.bio||""),b(s.display_name||""),j(s.username||""),y(s.location||""),w(s.avatar_url||"")}else console.error("Error fetching profile for settings:",u),m({title:"Error",description:"Could not load profile data.",variant:"destructive"});x(!1)},U=s=>{const u=s.target.files?.[0];if(u){const f=new FileReader;f.onloadend=()=>{w(f.result),m({title:"Profile picture updated (Placeholder)",description:"Image logic needs actual Supabase storage implementation."})},f.readAsDataURL(u)}},L=async()=>{if(!r||C){m({title:"Error",description:"User not authenticated or loading",variant:"destructive"});return}x(!0);try{await V({username:v,display_name:d,bio:i,location:N}),m({title:"Settings Updated",description:"Your changes have been saved to the database.",variant:"success"})}catch(s){console.error("Save error:",s),m({title:"Error",description:`Failed to save changes: ${s.message}`,variant:"destructive"})}finally{x(!1)}};return C||!l?e.jsxs("div",{className:"min-h-screen pb-32 overflow-hidden bg-background",children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-24 flex items-center gap-4",children:[e.jsx(n,{className:"h-10 w-10 rounded-full"}),e.jsx(n,{className:"h-8 w-32"})]}),e.jsxs("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsx(n,{className:"w-24 h-24 rounded-full mb-2"})}),e.jsxs("div",{className:"space-y-6",children:[[1,2,3,4].map(s=>e.jsxs("div",{children:[e.jsx(n,{className:"h-4 w-20 mb-2"}),e.jsx(n,{className:"h-12 w-full rounded-2xl"})]},s)),e.jsx(n,{className:"h-12 w-full rounded-2xl"})]})]})]}),e.jsx(k,{})]}):e.jsxs("div",{className:"min-h-screen pb-32 overflow-hidden bg-background",children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-24 animate-fade-in flex items-center gap-4",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"rounded-full",children:e.jsx(X,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),e.jsx("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg animate-scale-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsxs(G,{children:[e.jsx(D,{asChild:!0,children:e.jsxs("div",{className:"relative cursor-pointer group",children:[e.jsxs(F,{className:"w-24 h-24 ring-4 ring-primary/20 shadow-lg",children:[e.jsx(H,{src:I}),e.jsx(q,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white text-3xl font-bold",children:d?.toUpperCase()||"U"})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx($,{className:"h-6 w-6 text-white"})})]})}),e.jsxs(P,{className:"sm:max-w-md",children:[e.jsx(E,{children:e.jsx(A,{children:"Change Profile Picture"})}),e.jsx("div",{className:"flex flex-col gap-4 py-4",children:e.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90 file:cursor-pointer"})})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Username"}),e.jsx(g,{value:v,onChange:s=>j(s.target.value),placeholder:"Enter your username",className:"h-12 rounded-2xl glass border-2 border-border/50 focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Display Name"}),e.jsx(g,{value:d,onChange:s=>b(s.target.value),placeholder:"Enter your display name",className:"h-12 rounded-2xl glass border-2 border-border/50 focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bio"}),e.jsx(B,{value:i,onChange:s=>o(s.target.value),placeholder:"Tell us about yourself",className:"min-h-[100px] rounded-2xl glass border-2 border-border/50 resize-none focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx(g,{value:N,onChange:s=>y(s.target.value),placeholder:"Enter your location",className:"h-12 rounded-2xl glass border-2 border-border/50 focus:border-blue-500 transition-colors"})]}),e.jsx(S,{onClick:L,className:"w-full h-12 rounded-2xl bg-primary hover:bg-primary/90 font-semibold transition-apple",children:"Save Changes"})]})})]}),e.jsx(k,{})]})};export{oe as default};
