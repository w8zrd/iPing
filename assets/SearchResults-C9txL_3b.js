import{r as l,a as _,c as C,s as m,j as e}from"./index-D5B3vO8Q.js";import{N as $}from"./Navigation-_NdfecaC.js";import{H as P}from"./Header-vvNVPhLB.js";import{A as S,a as H}from"./Avatar-Cl00YIVg.js";import{B as L}from"./Button-rs4NsoCb.js";import{P as A}from"./textParser-BPKK_KmE.js";import{A as D}from"./arrow-left-CbUCReXG.js";import{C as b}from"./check-Dtzjd2fd.js";import{c as E}from"./createLucideIcon-BsuKKDQx.js";import"./x-DFM2k5ZH.js";const U=E("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);function R(a,d){const[i,n]=l.useState(a);return l.useEffect(()=>{const o=setTimeout(()=>n(a),d);return()=>{clearTimeout(o)}},[a,d]),i}const K=()=>{const a=_(),[d]=C(),i=d.get("q")||"",[n]=R(i,300),[o,p]=l.useState([]),[c,u]=l.useState([]),[x,g]=l.useState([]);l.useEffect(()=>{window.scrollTo(0,0),n.trim()&&v(n.trim())},[n]);const v=async s=>{const t=s.startsWith("#"),r=t?s.substring(1).toLowerCase():s.toLowerCase();if(t){const{data:f}=await m.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").ilike("content",`%#${r}%`).order("created_at",{ascending:!1}),{data:h}=await m.from("profiles").select("*").ilike("bio",`%#${r}%`);u(f||[]),p(h||[]),g([])}else{const{data:f}=await m.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").or(`content.ilike.%${r}%`).order("created_at",{ascending:!1}),{data:h}=await m.from("profiles").select("*").or(`username.ilike.%${r}%,display_name.ilike.%${r}%,bio.ilike.%${r}%`),j=new Set,{data:w}=await m.from("posts").select("content");w?.forEach(k=>{const y=k.content.match(/#\w+/g);y&&y.forEach(N=>{N.toLowerCase().includes(r)&&j.add(N)})}),u(f||[]),p(h||[]),g(Array.from(j).slice(0,5))}};return e.jsxs("div",{className:"min-h-screen pb-20 bg-background",children:[e.jsx(P,{}),e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-24 animate-fade-in flex items-center gap-4",children:[e.jsx(L,{variant:"ghost",size:"icon",onClick:()=>a(-1),className:"rounded-full",children:e.jsx(D,{className:"h-5 w-5"})}),e.jsxs("h1",{className:"text-2xl font-bold",children:['Results for "',i,'"']})]}),c.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Posts"}),e.jsx("div",{className:"space-y-4",children:c.map((s,t)=>e.jsxs("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${t*.05}s`},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("button",{onClick:()=>a(`/profile/${s.profiles?.username}`),className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold text-sm hover:scale-105 transition-apple",children:s.profiles?.display_name?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>a(`/profile/${s.profiles?.username}`),className:"font-semibold hover:text-primary transition-apple",children:s.profiles?.display_name}),s.profiles?.verified&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(b,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",s.profiles?.username," Â· ",new Date(s.created_at).toLocaleString()]})]})]}),e.jsx("p",{className:"text-foreground/90",children:e.jsx(A,{text:s.content})}),s.image_url&&e.jsx("img",{src:s.image_url,alt:"Post",className:"rounded-2xl w-full mt-3 max-h-96 object-cover"})]},s.id))})]}),x.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Hashtags"}),e.jsx("div",{className:"space-y-3",children:x.map((s,t)=>e.jsx("button",{onClick:()=>a(`/search?q=${encodeURIComponent(s)}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform w-full text-left",style:{animationDelay:`${(c.length+t)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(U,{className:"h-6 w-6 text-primary"})}),e.jsx("span",{className:"font-semibold text-primary",children:s})]})},t))})]}),o.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People"}),e.jsx("div",{className:"space-y-3",children:o.map((s,t)=>e.jsx("div",{onClick:()=>a(`/profile/${s.username}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform",style:{animationDelay:`${(c.length+x.length+t)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-12 h-12",children:e.jsx(H,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white font-bold",children:s.display_name?.toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"font-semibold",children:s.display_name}),s.verified&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(b,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"text-sm text-foreground/70 mt-1",children:s.bio})]})]})},s.id))})]}),o.length===0&&c.length===0&&x.length===0&&i&&e.jsx("div",{className:"glass rounded-3xl p-8 text-center animate-scale-in",children:e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',i,'"']})})]}),e.jsx($,{})]})};export{K as default};
