import{u as I,c as _,r as t,j as e,L as A,s as p,l as f}from"./index-B988mT6b.js";import{N as F}from"./Navigation-C_mdfttj.js";import{u as T}from"./use-toast-BhhiqXJo.js";import{A as q}from"./arrow-left-w9cjPnmt.js";import{c as z}from"./createLucideIcon-C40F9rup.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=z("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Y=()=>{var k;const i=I(),{user:n,loading:c}=_(),[d,U]=t.useState(null),[h,g]=t.useState(""),[o,x]=t.useState(""),[r,b]=t.useState(""),[v,y]=t.useState(""),[j,N]=t.useState(""),[w,S]=t.useState(!1),{toast:u}=T(),[E,C]=t.useState("");t.useEffect(()=>{if(c||!n){i("/auth");return}(async()=>{const{data:s,error:l}=await p.from("profiles").select("id, username, display_name, bio, location, avatar_url").eq("id",n.id).single();if(l||!s){f.error("Error fetching profile",l,{userMessage:"Failed to load profile data.",showToast:!0});return}U(s),g(s.bio||""),x(s.display_name||""),b(s.username||""),y(s.location||""),N(s.avatar_url||""),C(s.username||"")})()},[n,c,i,u]);const L=a=>{var l;const s=(l=a.target.files)==null?void 0:l[0];if(s){const m=new FileReader;m.onloadend=()=>{N(m.result),u({title:"Profile picture previewed",description:"Click Save Changes to finalize the upload."})},m.readAsDataURL(s)}},P=async()=>{if(!n||!d)return;S(!0);const{error:a}=await p.from("profiles").update({display_name:o,bio:h,username:r,location:v}).eq("id",d.id);if(S(!1),a)f.error("Error saving settings",a,{userMessage:`Failed to save changes: ${a.message}`,showToast:!0});else if(u({title:"Settings Updated",description:"Your changes have been saved"}),E!==r){const{error:s}=await p.auth.updateUser({data:{username:r,display_name:o}});s?f.error("Failed to update auth user metadata",s):C(r)}};return c||!d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(A,{})}):e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-8 animate-fade-in flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i(-1),className:"p-2 rounded-full transition-colors text-muted-foreground hover:bg-background/80",children:e.jsx(q,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),e.jsx("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg animate-scale-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsxs("label",{className:"relative cursor-pointer group w-24 h-24",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:"hidden"}),e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white text-3xl font-bold flex items-center justify-center ring-4 ring-primary/20 shadow-lg",children:[((k=o[0])==null?void 0:k.toUpperCase())||"U",j&&e.jsx("img",{src:j,alt:"Profile",className:"w-full h-full object-cover rounded-full"})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(D,{className:"h-6 w-6 text-white"})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Username"}),e.jsx("input",{type:"text",value:r,onChange:a=>b(a.target.value),placeholder:"Enter your username",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Display Name"}),e.jsx("input",{type:"text",value:o,onChange:a=>x(a.target.value),placeholder:"Enter your display name",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bio"}),e.jsx("textarea",{value:h,onChange:a=>g(a.target.value),placeholder:"Tell us about yourself",className:"min-h-[100px] rounded-2xl glass border-border/50 resize-none focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx("input",{type:"text",value:v,onChange:a=>y(a.target.value),placeholder:"Enter your location",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple p-3 bg-transparent focus:outline-none w-full"})]}),e.jsx("button",{onClick:P,disabled:w,className:"w-full h-12 rounded-2xl bg-primary hover:bg-primary/90 font-semibold transition-apple disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Saving...":"Save Changes"})]})})]}),e.jsx(F,{})]})};export{Y as default};
