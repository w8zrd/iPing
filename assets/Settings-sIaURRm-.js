import{r as s,j as e,u as U,c as _,s as R}from"./index-DI89oLvi.js";import{N as z}from"./Navigation-CCuSAfZq.js";import{B as k}from"./Button-Cw2Gr0ER.js";import{L as B,I as g}from"./Input-Cfhs3MkO.js";import{T as O}from"./Textarea-DIh8qrk3.js";import{c as f}from"./utils-BNf5BS2b.js";import{X as F}from"./x-CHZwQEb0.js";import{A as H,b as q,a as M}from"./Avatar-UWX7lTYm.js";import{u as V}from"./use-toast-DaUEFXXE.js";import{a as X}from"./user-TwC2sY1s.js";import{A as Y}from"./arrow-left-BobK73xn.js";import{c as $}from"./createLucideIcon-CJ3bZHtC.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=$("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),h=s.createContext({open:!1,setOpen:()=>{}}),J=({children:t})=>{const[r,o]=s.useState(!1);return e.jsx(h.Provider,{value:{open:r,setOpen:o},children:t})},S=s.forwardRef(({asChild:t,className:r,...o},c)=>{const{setOpen:n}=s.useContext(h),i=t?"span":"button";return e.jsx(i,{ref:c,className:f("cursor-pointer",r),onClick:()=>n(!0),...o})});S.displayName="DialogTrigger";const D=s.forwardRef(({className:t,children:r,...o},c)=>{const{open:n,setOpen:i}=s.useContext(h);return n?e.jsx("div",{className:"fixed inset-0 z-50 overflow-hidden",onClick:()=>i(!1),children:e.jsxs("div",{ref:c,className:f("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 sm:rounded-lg",t),onClick:l=>l.stopPropagation(),...o,children:[r,e.jsxs("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",onClick:()=>i(!1),children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})}):null});D.displayName="DialogContent";const P=({className:t,...r})=>e.jsx("div",{className:f("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});P.displayName="DialogHeader";const E=s.forwardRef(({className:t,...r},o)=>e.jsx("h2",{ref:o,className:f("text-lg font-semibold leading-none tracking-tight",t),...r}));E.displayName="DialogTitle";const ne=()=>{const t=U(),{user:r}=_(),[o,c]=s.useState(null),[n,i]=s.useState(""),[l,b]=s.useState(""),[v,j]=s.useState(""),[y,N]=s.useState(""),[L,C]=s.useState(""),[w,u]=s.useState(!1),{toast:d}=V();s.useEffect(()=>{A()},[r]);const A=async()=>{if(!r)return;u(!0);const{data:a,error:m}=await R.from("profiles").select("username, display_name, bio, verified, location, avatar_url").eq("id",r.id).single();if(!m&&a){const p={...a,display_name:a.display_name};c(p),i(a.bio||""),b(a.display_name||""),j(a.username||""),N(a.location||""),C(a.avatar_url||"")}else console.error("Error fetching profile for settings:",m),d({title:"Error",description:"Could not load profile data.",variant:"destructive"});u(!1)},I=a=>{var p;const m=(p=a.target.files)==null?void 0:p[0];if(m){const x=new FileReader;x.onloadend=()=>{C(x.result),d({title:"Profile picture updated (Placeholder)",description:"Image logic needs actual Supabase storage implementation."})},x.readAsDataURL(m)}},T=async()=>{if(!r||w){d({title:"Error",description:"User not authenticated or loading",variant:"destructive"});return}u(!0);try{await X({username:v,display_name:l,bio:n,location:y}),d({title:"Settings Updated",description:"Your changes have been saved to the database.",variant:"success"})}catch(a){console.error("Save error:",a),d({title:"Error",description:`Failed to save changes: ${a.message}`,variant:"destructive"})}finally{u(!1)}};return w||!o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-8 animate-fade-in flex items-center gap-4",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"rounded-full",children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),e.jsx("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg animate-scale-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col items-center mb-6",children:e.jsxs(J,{children:[e.jsx(S,{asChild:!0,children:e.jsxs("div",{className:"relative cursor-pointer group",children:[e.jsxs(H,{className:"w-24 h-24 ring-4 ring-primary/20 shadow-lg",children:[e.jsx(q,{src:L}),e.jsx(M,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white text-3xl font-bold",children:(l==null?void 0:l.toUpperCase())||"U"})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(G,{className:"h-6 w-6 text-white"})})]})}),e.jsxs(D,{className:"sm:max-w-md",children:[e.jsx(P,{children:e.jsx(E,{children:"Change Profile Picture"})}),e.jsx("div",{className:"flex flex-col gap-4 py-4",children:e.jsx("input",{type:"file",accept:"image/*",onChange:I,className:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90 file:cursor-pointer"})})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Username"}),e.jsx(g,{value:v,onChange:a=>j(a.target.value),placeholder:"Enter your username",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Display Name"}),e.jsx(g,{value:l,onChange:a=>b(a.target.value),placeholder:"Enter your display name",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bio"}),e.jsx(O,{value:n,onChange:a=>i(a.target.value),placeholder:"Tell us about yourself",className:"min-h-[100px] rounded-2xl glass border-border/50 resize-none focus:border-primary transition-apple"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx(g,{value:y,onChange:a=>N(a.target.value),placeholder:"Enter your location",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),e.jsx(k,{onClick:T,className:"w-full h-12 rounded-2xl bg-primary hover:bg-primary/90 font-semibold transition-apple",children:"Save Changes"})]})})]}),e.jsx(z,{})]})};export{ne as default};
