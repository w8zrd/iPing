import{u as k,b as _,r as c,s as n,j as e}from"./index-G4AyO64r.js";import{N as C}from"./Navigation-C9Q6-BAp.js";import{H as $}from"./Header-DdyTimhQ.js";import{A as P,a as S}from"./Avatar-CbyZJF5s.js";import{B as H}from"./Button-DzlWeRO-.js";import{P as L}from"./textParser-Cp_FlC1u.js";import{A}from"./arrow-left-BT0WQcYk.js";import{C as y}from"./check-DO0X9b6F.js";import{c as U}from"./createLucideIcon-9Q53b8yI.js";import"./x-DYwVNTyk.js";import"./utils-Dtjc6EhN.js";const E=U("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),M=()=>{const i=k(),[N]=_(),r=N.get("q")||"",[m,f]=c.useState([]),[l,h]=c.useState([]),[o,p]=c.useState([]);c.useEffect(()=>{window.scrollTo(0,0),r.trim()&&v(r.trim())},[r]);const v=async s=>{const a=s.startsWith("#"),t=a?s.substring(1).toLowerCase():s.toLowerCase();if(a){const{data:d}=await n.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").ilike("content",`%#${t}%`).order("created_at",{ascending:!1}),{data:x}=await n.from("profiles").select("*").ilike("bio",`%#${t}%`);h(d||[]),f(x||[]),p([])}else{const{data:d}=await n.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").or(`content.ilike.%${t}%`).order("created_at",{ascending:!1}),{data:x}=await n.from("profiles").select("*").or(`username.ilike.%${t}%,display_name.ilike.%${t}%,bio.ilike.%${t}%`),u=new Set,{data:b}=await n.from("posts").select("content");b?.forEach(w=>{const g=w.content.match(/#\w+/g);g&&g.forEach(j=>{j.toLowerCase().includes(t)&&u.add(j)})}),h(d||[]),f(x||[]),p(Array.from(u).slice(0,5))}};return e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsx($,{}),e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-24 animate-fade-in flex items-center gap-4",children:[e.jsx(H,{variant:"ghost",size:"icon",onClick:()=>i(-1),className:"rounded-full",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsxs("h1",{className:"text-2xl font-bold",children:['Results for "',r,'"']})]}),l.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Posts"}),e.jsx("div",{className:"space-y-4",children:l.map((s,a)=>e.jsxs("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${a*.05}s`},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("button",{onClick:()=>i(`/profile/${s.profiles?.username}`),className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold text-sm hover:scale-105 transition-apple",children:s.profiles?.display_name?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>i(`/profile/${s.profiles?.username}`),className:"font-semibold hover:text-primary transition-apple",children:s.profiles?.display_name}),s.profiles?.verified&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(y,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",s.profiles?.username," Â· ",new Date(s.created_at).toLocaleString()]})]})]}),e.jsx("p",{className:"text-foreground/90",children:e.jsx(L,{text:s.content})}),s.image_url&&e.jsx("img",{src:s.image_url,alt:"Post",className:"rounded-2xl w-full mt-3 max-h-96 object-cover"})]},s.id))})]}),o.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Hashtags"}),e.jsx("div",{className:"space-y-3",children:o.map((s,a)=>e.jsx("button",{onClick:()=>i(`/search?q=${encodeURIComponent(s)}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform w-full text-left",style:{animationDelay:`${(l.length+a)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-primary"})}),e.jsx("span",{className:"font-semibold text-primary",children:s})]})},a))})]}),m.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People"}),e.jsx("div",{className:"space-y-3",children:m.map((s,a)=>e.jsx("div",{onClick:()=>i(`/profile/${s.username}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform",style:{animationDelay:`${(l.length+o.length+a)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"w-12 h-12",children:e.jsx(S,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white font-bold",children:s.display_name?.toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"font-semibold",children:s.display_name}),s.verified&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(y,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"text-sm text-foreground/70 mt-1",children:s.bio})]})]})},s.id))})]}),m.length===0&&l.length===0&&o.length===0&&r&&e.jsx("div",{className:"glass rounded-3xl p-8 text-center animate-scale-in",children:e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',r,'"']})})]}),e.jsx(C,{})]})};export{M as default};
