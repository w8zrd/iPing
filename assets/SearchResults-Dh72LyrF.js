import{u as k,b as _,r as p,s as x,j as e}from"./index-DI89oLvi.js";import{N as C}from"./Navigation-CCuSAfZq.js";import{H as $}from"./Header-D2yrwniz.js";import{A as S,a as H}from"./Avatar-UWX7lTYm.js";import{B as L}from"./Button-Cw2Gr0ER.js";import{P}from"./textParser-Bya1rKIJ.js";import{A}from"./arrow-left-BobK73xn.js";import{C as v}from"./check-DN1bmkHn.js";import{c as U}from"./createLucideIcon-CJ3bZHtC.js";import"./x-CHZwQEb0.js";import"./utils-BNf5BS2b.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=U("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),M=()=>{const c=k(),[b]=_(),i=b.get("q")||"",[u,g]=p.useState([]),[m,j]=p.useState([]),[f,y]=p.useState([]);p.useEffect(()=>{window.scrollTo(0,0),i.trim()&&w(i.trim())},[i]);const w=async s=>{const t=s.startsWith("#"),a=t?s.substring(1).toLowerCase():s.toLowerCase();if(t){const{data:l}=await x.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").ilike("content",`%#${a}%`).order("created_at",{ascending:!1}),{data:n}=await x.from("profiles").select("*").ilike("bio",`%#${a}%`);j(l||[]),g(n||[]),y([])}else{const{data:l}=await x.from("posts").select("*, profiles!posts_user_id_fkey(username, display_name, verified)").or(`content.ilike.%${a}%`).order("created_at",{ascending:!1}),{data:n}=await x.from("profiles").select("*").or(`username.ilike.%${a}%,display_name.ilike.%${a}%,bio.ilike.%${a}%`),d=new Set,{data:o}=await x.from("posts").select("content");o==null||o.forEach(h=>{const r=h.content.match(/#\w+/g);r&&r.forEach(N=>{N.toLowerCase().includes(a)&&d.add(N)})}),j(l||[]),g(n||[]),y(Array.from(d).slice(0,5))}};return e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsx($,{}),e.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-8 pt-24 animate-fade-in flex items-center gap-4",children:[e.jsx(L,{variant:"ghost",size:"icon",onClick:()=>c(-1),className:"rounded-full",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsxs("h1",{className:"text-2xl font-bold",children:['Results for "',i,'"']})]}),m.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Posts"}),e.jsx("div",{className:"space-y-4",children:m.map((s,t)=>{var a,l,n,d,o,h;return e.jsxs("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${t*.05}s`},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("button",{onClick:()=>{var r;return c(`/profile/${(r=s.profiles)==null?void 0:r.username}`)},className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold text-sm hover:scale-105 transition-apple",children:((n=(l=(a=s.profiles)==null?void 0:a.display_name)==null?void 0:l[0])==null?void 0:n.toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>{var r;return c(`/profile/${(r=s.profiles)==null?void 0:r.username}`)},className:"font-semibold hover:text-primary transition-apple",children:(d=s.profiles)==null?void 0:d.display_name}),((o=s.profiles)==null?void 0:o.verified)&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(v,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",(h=s.profiles)==null?void 0:h.username," Â· ",new Date(s.created_at).toLocaleString()]})]})]}),e.jsx("p",{className:"text-foreground/90",children:e.jsx(P,{text:s.content})}),s.image_url&&e.jsx("img",{src:s.image_url,alt:"Post",className:"rounded-2xl w-full mt-3 max-h-96 object-cover"})]},s.id)})})]}),f.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Hashtags"}),e.jsx("div",{className:"space-y-3",children:f.map((s,t)=>e.jsx("button",{onClick:()=>c(`/search?q=${encodeURIComponent(s)}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform w-full text-left",style:{animationDelay:`${(m.length+t)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-primary"})}),e.jsx("span",{className:"font-semibold text-primary",children:s})]})},t))})]}),u.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People"}),e.jsx("div",{className:"space-y-3",children:u.map((s,t)=>{var a;return e.jsx("div",{onClick:()=>c(`/profile/${s.username}`),className:"glass-strong rounded-3xl p-4 shadow-md animate-fade-in cursor-pointer hover:scale-[1.02] transition-transform",style:{animationDelay:`${(m.length+f.length+t)*.05}s`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-12 h-12",children:e.jsx(H,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white font-bold",children:(a=s.display_name)==null?void 0:a.toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"font-semibold",children:s.display_name}),s.verified&&e.jsx("div",{className:"flex items-center justify-center w-4 h-4 bg-primary rounded-full",children:e.jsx(v,{className:"h-3 w-3 text-white stroke-"})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"text-sm text-foreground/70 mt-1",children:s.bio})]})]})},s.id)})})]}),u.length===0&&m.length===0&&f.length===0&&i&&e.jsx("div",{className:"glass rounded-3xl p-8 text-center animate-scale-in",children:e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',i,'"']})})]}),e.jsx(C,{})]})};export{M as default};
