import{c as C,r as d,m as K,j as e,b as Q,i as j,h as N,P as X,n as _,t as H,o as O,s as J,v as w,w as T}from"./index-BviwBOFj.js";import{N as W}from"./Navigation-CBbH8e9z.js";import{B as k}from"./button-B8dY9mXZ.js";import{I as Y}from"./input-Cj_0U1ju.js";import{u as Z,c as S,R as ee,I as ae}from"./index-BhQG-2KR.js";import{u as se}from"./index-k2Ks3PZ_.js";import"./index-CPHWhxBT.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=C("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=C("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=C("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var y="Tabs",[ne]=Q(y,[S]),U=S(),[re,A]=ne(y),I=d.forwardRef((s,t)=>{const{__scopeTabs:i,value:r,onValueChange:o,defaultValue:c,orientation:l="horizontal",dir:u,activationMode:f="automatic",...v}=s,m=Z(u),[a,n]=K({prop:r,onChange:o,defaultProp:c??"",caller:y});return e.jsx(re,{scope:i,baseId:se(),value:a,onValueChange:n,orientation:l,dir:m,activationMode:f,children:e.jsx(j.div,{dir:m,"data-orientation":l,...v,ref:t})})});I.displayName=y;var M="TabsList",E=d.forwardRef((s,t)=>{const{__scopeTabs:i,loop:r=!0,...o}=s,c=A(M,i),l=U(i);return e.jsx(ee,{asChild:!0,...l,orientation:c.orientation,dir:c.dir,loop:r,children:e.jsx(j.div,{role:"tablist","aria-orientation":c.orientation,...o,ref:t})})});E.displayName=M;var F="TabsTrigger",V=d.forwardRef((s,t)=>{const{__scopeTabs:i,value:r,disabled:o=!1,...c}=s,l=A(F,i),u=U(i),f=B(l.baseId,r),v=P(l.baseId,r),m=r===l.value;return e.jsx(ae,{asChild:!0,...u,focusable:!o,active:m,children:e.jsx(j.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":v,"data-state":m?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:f,...c,ref:t,onMouseDown:N(s.onMouseDown,a=>{!o&&a.button===0&&a.ctrlKey===!1?l.onValueChange(r):a.preventDefault()}),onKeyDown:N(s.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&l.onValueChange(r)}),onFocus:N(s.onFocus,()=>{const a=l.activationMode!=="manual";!m&&!o&&a&&l.onValueChange(r)})})})});V.displayName=F;var $="TabsContent",D=d.forwardRef((s,t)=>{const{__scopeTabs:i,value:r,forceMount:o,children:c,...l}=s,u=A($,i),f=B(u.baseId,r),v=P(u.baseId,r),m=r===u.value,a=d.useRef(m);return d.useEffect(()=>{const n=requestAnimationFrame(()=>a.current=!1);return()=>cancelAnimationFrame(n)},[]),e.jsx(X,{present:o||m,children:({present:n})=>e.jsx(j.div,{"data-state":m?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!n,id:v,tabIndex:0,...l,ref:t,style:{...s.style,animationDuration:a.current?"0s":void 0},children:n&&c})})});D.displayName=$;function B(s,t){return`${s}-trigger-${t}`}function P(s,t){return`${s}-content-${t}`}var oe=I,L=E,G=V,z=D;const le=oe,q=d.forwardRef(({className:s,...t},i)=>e.jsx(L,{ref:i,className:_("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));q.displayName=L.displayName;const h=d.forwardRef(({className:s,...t},i)=>e.jsx(G,{ref:i,className:_("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...t}));h.displayName=G.displayName;const g=d.forwardRef(({className:s,...t},i)=>e.jsx(z,{ref:i,className:_("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));g.displayName=z.displayName;function de(s,t){const[i,r]=d.useState(s);return d.useEffect(()=>{const o=setTimeout(()=>r(s),t);return()=>{clearTimeout(o)}},[s,t]),i}const be=()=>{const[s,t]=d.useState([]),[i,r]=d.useState(""),o=de(i,300),{isAdmin:c,user:l}=H(),u=O(),{toast:f}=J();d.useEffect(()=>{if(!c){u("/");return}(async()=>{const{data:n,error:p}=await w.from("profiles").select("id, email, is_verified, is_banned").ilike("email",`%${o}%`);p?T.error("Error fetching users",p,{userMessage:"Failed to fetch user list."}):t(n.map(x=>({id:x.id,email:x.email,verified:x.is_verified,banned:x.is_banned})))})()},[c,u,o]);const v=async(a,n)=>{const{error:p}=await w.from("profiles").update({is_verified:!n}).eq("id",a);p?T.error("Failed to update verification status",p,{userMessage:`Failed to update verification status for user ${a}.`,showToast:!0}):(t(x=>x.map(b=>b.id===a?{...b,verified:!n}:b)),f({title:"Badge Updated",description:"User verification status changed"}))},m=async(a,n)=>{const{error:p}=await w.from("profiles").update({is_banned:!n}).eq("id",a);p?T.error("Failed to update ban status",p,{userMessage:`Failed to update ban status for user ${a}.`,showToast:!0}):(t(x=>x.map(b=>b.id===a?{...b,banned:!n}:b)),f({title:"User Status Updated",description:"User ban status changed"}))};return c?e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"max-w-4xl mx-auto p-4",children:[e.jsx("div",{className:"mb-8 pt-8 animate-fade-in",children:e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ie,{className:"h-8 w-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"})]})}),e.jsxs(le,{defaultValue:"users",className:"w-full",children:[e.jsxs(q,{className:"grid w-full grid-cols-3 glass-strong rounded-3xl p-2 mb-6",children:[e.jsx(h,{value:"users",className:"rounded-2xl",children:"Users"}),e.jsx(h,{value:"badges",className:"rounded-2xl",children:"Badges"}),e.jsx(h,{value:"bans",className:"rounded-2xl",children:"Bans"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(Y,{placeholder:"Search users...",value:i,onChange:a=>r(a.target.value),className:"h-12 rounded-2xl glass-strong border-border/50 focus:border-primary transition-apple"})}),e.jsx(g,{value:"users",className:"space-y-4",children:s.map((a,n)=>e.jsx("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${n*.05}s`},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold",children:a.email&&a.email?a.email.toUpperCase():"U"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:a.email}),a.verified&&e.jsx(R,{className:"h-4 w-4 text-primary fill-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.banned?"Banned":"Active"})]})]})})},a.id))}),e.jsx(g,{value:"badges",className:"space-y-4",children:s.map((a,n)=>e.jsx("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${n*.05}s`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold",children:a.email&&a.email?a.email.toUpperCase():"U"}),e.jsx("div",{children:e.jsx("span",{className:"font-semibold",children:a.email})})]}),e.jsxs(k,{onClick:()=>v(a.id,a.verified),variant:a.verified?"default":"outline",className:"rounded-2xl transition-apple",children:[a.verified?e.jsx(R,{className:"h-4 w-4 mr-2"}):e.jsx(te,{className:"h-4 w-4 mr-2"}),a.verified?"Verified":"Verify"]})]})},a.id))}),e.jsx(g,{value:"bans",className:"space-y-4",children:s.map((a,n)=>e.jsx("div",{className:"glass rounded-3xl p-6 shadow-md animate-fade-in",style:{animationDelay:`${n*.05}s`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-white font-semibold",children:a.email&&a.email?a.email.toUpperCase():"U"}),e.jsx("div",{children:e.jsx("span",{className:"font-semibold",children:a.email})})]}),e.jsx(k,{onClick:()=>m(a.id,a.banned),variant:a.banned?"destructive":"outline",className:"rounded-2xl transition-apple",children:a.banned?"Unban":"Ban User"})]})},a.id))})]})]}),e.jsx(W,{})]}):null};export{be as default};
