import{c as xe,r as i,j as t,a as he,m as ve,b as ye,g as I,i as b,h as y,P as S,f as be,D as Ne,y as je,n as N,X as De,o as Ce,t as Re,s as Ee,L as _e,v as E,w as _}from"./index-DducP8rb.js";import{N as we}from"./Navigation-P7o5lEdf.js";import{B as U}from"./button-Bam1vjCP.js";import{I as w}from"./input-Ce_VQZZ0.js";import{T as Pe}from"./textarea-CKc33OOl.js";import{u as P}from"./index-DLm2BZoO.js";import{h as Ie,R as Se,u as Ae,F as Oe}from"./Combination-BuE-uhou.js";import{A as Te,b as Fe,a as Me}from"./avatar-Bh045AcM.js";import{A as ke}from"./arrow-left-P8L71n6O.js";import"./index-DhRncdj7.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=xe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);function We(e){const a=$e(e),o=i.forwardRef((r,s)=>{const{children:n,...c}=r,l=i.Children.toArray(n),u=l.find(Be);if(u){const d=u.props.children,m=l.map(x=>x===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:x);return t.jsx(a,{...c,ref:s,children:i.isValidElement(d)?i.cloneElement(d,void 0,m):null})}return t.jsx(a,{...c,ref:s,children:n})});return o.displayName=`${e}.Slot`,o}function $e(e){const a=i.forwardRef((o,r)=>{const{children:s,...n}=o;if(i.isValidElement(s)){const c=ze(s),l=Ve(n,s.props);return s.type!==i.Fragment&&(l.ref=r?he(r,c):c),i.cloneElement(s,l)}return i.Children.count(s)>1?i.Children.only(null):null});return a.displayName=`${e}.SlotClone`,a}var Ue=Symbol("radix.slottable");function Be(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ue}function Ve(e,a){const o={...a};for(const r in a){const s=e[r],n=a[r];/^on[A-Z]/.test(r)?s&&n?o[r]=(...l)=>{const u=n(...l);return s(...l),u}:s&&(o[r]=s):r==="style"?o[r]={...s,...n}:r==="className"&&(o[r]=[s,n].filter(Boolean).join(" "))}return{...e,...o}}function ze(e){var r,s;let a=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,o=a&&"isReactWarning"in a&&a.isReactWarning;return o?e.ref:(a=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,o=a&&"isReactWarning"in a&&a.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}var D="Dialog",[B]=ye(D),[Ge,g]=B(D),V=e=>{const{__scopeDialog:a,children:o,open:r,defaultOpen:s,onOpenChange:n,modal:c=!0}=e,l=i.useRef(null),u=i.useRef(null),[d,m]=ve({prop:r,defaultProp:s??!1,onChange:n,caller:D});return t.jsx(Ge,{scope:a,triggerRef:l,contentRef:u,contentId:P(),titleId:P(),descriptionId:P(),open:d,onOpenChange:m,onOpenToggle:i.useCallback(()=>m(x=>!x),[m]),modal:c,children:o})};V.displayName=D;var z="DialogTrigger",G=i.forwardRef((e,a)=>{const{__scopeDialog:o,...r}=e,s=g(z,o),n=I(a,s.triggerRef);return t.jsx(b.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":T(s.open),...r,ref:n,onClick:y(e.onClick,s.onOpenToggle)})});G.displayName=z;var A="DialogPortal",[He,H]=B(A,{forceMount:void 0}),q=e=>{const{__scopeDialog:a,forceMount:o,children:r,container:s}=e,n=g(A,a);return t.jsx(He,{scope:a,forceMount:o,children:i.Children.map(r,c=>t.jsx(S,{present:o||n.open,children:t.jsx(be,{asChild:!0,container:s,children:c})}))})};q.displayName=A;var j="DialogOverlay",Y=i.forwardRef((e,a)=>{const o=H(j,e.__scopeDialog),{forceMount:r=o.forceMount,...s}=e,n=g(j,e.__scopeDialog);return n.modal?t.jsx(S,{present:r||n.open,children:t.jsx(Ye,{...s,ref:a})}):null});Y.displayName=j;var qe=We("DialogOverlay.RemoveScroll"),Ye=i.forwardRef((e,a)=>{const{__scopeDialog:o,...r}=e,s=g(j,o);return t.jsx(Se,{as:qe,allowPinchZoom:!0,shards:[s.contentRef],children:t.jsx(b.div,{"data-state":T(s.open),...r,ref:a,style:{pointerEvents:"auto",...r.style}})})}),h="DialogContent",Z=i.forwardRef((e,a)=>{const o=H(h,e.__scopeDialog),{forceMount:r=o.forceMount,...s}=e,n=g(h,e.__scopeDialog);return t.jsx(S,{present:r||n.open,children:n.modal?t.jsx(Ze,{...s,ref:a}):t.jsx(Ke,{...s,ref:a})})});Z.displayName=h;var Ze=i.forwardRef((e,a)=>{const o=g(h,e.__scopeDialog),r=i.useRef(null),s=I(a,o.contentRef,r);return i.useEffect(()=>{const n=r.current;if(n)return Ie(n)},[]),t.jsx(K,{...e,ref:s,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:y(e.onCloseAutoFocus,n=>{var c;n.preventDefault(),(c=o.triggerRef.current)==null||c.focus()}),onPointerDownOutside:y(e.onPointerDownOutside,n=>{const c=n.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0;(c.button===2||l)&&n.preventDefault()}),onFocusOutside:y(e.onFocusOutside,n=>n.preventDefault())})}),Ke=i.forwardRef((e,a)=>{const o=g(h,e.__scopeDialog),r=i.useRef(!1),s=i.useRef(!1);return t.jsx(K,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{var c,l;(c=e.onCloseAutoFocus)==null||c.call(e,n),n.defaultPrevented||(r.current||(l=o.triggerRef.current)==null||l.focus(),n.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:n=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,n),n.defaultPrevented||(r.current=!0,n.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=n.target;((d=o.triggerRef.current)==null?void 0:d.contains(c))&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&s.current&&n.preventDefault()}})}),K=i.forwardRef((e,a)=>{const{__scopeDialog:o,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:n,...c}=e,l=g(h,o),u=i.useRef(null),d=I(a,u);return Ae(),t.jsxs(t.Fragment,{children:[t.jsx(Oe,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:n,children:t.jsx(Ne,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":T(l.open),...c,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(Xe,{titleId:l.titleId}),t.jsx(Qe,{contentRef:u,descriptionId:l.descriptionId})]})]})}),O="DialogTitle",X=i.forwardRef((e,a)=>{const{__scopeDialog:o,...r}=e,s=g(O,o);return t.jsx(b.h2,{id:s.titleId,...r,ref:a})});X.displayName=O;var J="DialogDescription",Q=i.forwardRef((e,a)=>{const{__scopeDialog:o,...r}=e,s=g(J,o);return t.jsx(b.p,{id:s.descriptionId,...r,ref:a})});Q.displayName=J;var ee="DialogClose",te=i.forwardRef((e,a)=>{const{__scopeDialog:o,...r}=e,s=g(ee,o);return t.jsx(b.button,{type:"button",...r,ref:a,onClick:y(e.onClick,()=>s.onOpenChange(!1))})});te.displayName=ee;function T(e){return e?"open":"closed"}var ae="DialogTitleWarning",[vt,oe]=je(ae,{contentName:h,titleName:O,docsSlug:"dialog"}),Xe=({titleId:e})=>{const a=oe(ae),o=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return i.useEffect(()=>{e&&(document.getElementById(e)||console.error(o))},[o,e]),null},Je="DialogDescriptionWarning",Qe=({contentRef:e,descriptionId:a})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${oe(Je).contentName}}.`;return i.useEffect(()=>{var n;const s=(n=e.current)==null?void 0:n.getAttribute("aria-describedby");a&&s&&(document.getElementById(a)||console.warn(r))},[r,e,a]),null},et=V,tt=G,at=q,re=Y,se=Z,ne=X,ie=Q,ot=te;const rt=et,st=tt,nt=at,le=i.forwardRef(({className:e,...a},o)=>t.jsx(re,{ref:o,className:N("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));le.displayName=re.displayName;const ce=i.forwardRef(({className:e,children:a,...o},r)=>t.jsxs(nt,{children:[t.jsx(le,{}),t.jsxs(se,{ref:r,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...o,children:[a,t.jsxs(ot,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[t.jsx(De,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ce.displayName=se.displayName;const de=({className:e,...a})=>t.jsx("div",{className:N("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});de.displayName="DialogHeader";const ue=i.forwardRef(({className:e,...a},o)=>t.jsx(ne,{ref:o,className:N("text-lg font-semibold leading-none tracking-tight",e),...a}));ue.displayName=ne.displayName;const it=i.forwardRef(({className:e,...a},o)=>t.jsx(ie,{ref:o,className:N("text-sm text-muted-foreground",e),...a}));it.displayName=ie.displayName;const yt=()=>{var $;const e=Ce(),{user:a,loading:o}=Re(),[r,s]=i.useState(null),[n,c]=i.useState(""),[l,u]=i.useState(""),[d,m]=i.useState(""),[x,F]=i.useState(""),[fe,M]=i.useState(""),[k,L]=i.useState(!1),{toast:C}=Ee(),[pe,W]=i.useState("");i.useEffect(()=>{if(o||!a){e("/auth");return}(async()=>{const{data:p,error:v}=await E.from("profiles").select("id, username, display_name, bio, location, avatar_url").eq("id",a.id).single();if(v||!p){_.error("Error fetching profile",v,{userMessage:"Failed to load profile data.",showToast:!0});return}s(p),c(p.bio||""),u(p.display_name||""),m(p.username||""),F(p.location||""),M(p.avatar_url||""),W(p.username||"")})()},[a,o,e,C]);const ge=f=>{var v;const p=(v=f.target.files)==null?void 0:v[0];if(p){const R=new FileReader;R.onloadend=()=>{M(R.result),C({title:"Profile picture previewed",description:"Click Save Changes to finalize the upload."})},R.readAsDataURL(p)}},me=async()=>{if(!a||!r)return;L(!0);const{error:f}=await E.from("profiles").update({display_name:l,bio:n,username:d,location:x}).eq("id",r.id);if(L(!1),f)_.error("Error saving settings",f,{userMessage:`Failed to save changes: ${f.message}`,showToast:!0});else if(C({title:"Settings Updated",description:"Your changes have been saved"}),pe!==d){const{error:p}=await E.auth.updateUser({data:{username:d,display_name:l}});p?_.error("Failed to update auth user metadata",p):W(d)}};return o||!r?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx(_e,{})}):t.jsxs("div",{className:"min-h-screen pb-32",children:[t.jsxs("div",{className:"max-w-2xl mx-auto p-4",children:[t.jsxs("div",{className:"mb-8 pt-8 animate-fade-in flex items-center gap-4",children:[t.jsx(U,{variant:"ghost",size:"icon",onClick:()=>e(-1),className:"rounded-full",children:t.jsx(ke,{className:"h-5 w-5"})}),t.jsx("h1",{className:"text-3xl font-bold",children:"Settings"})]}),t.jsx("div",{className:"glass-strong rounded-3xl p-8 mb-6 shadow-lg animate-scale-in",children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex flex-col items-center mb-6",children:t.jsxs(rt,{children:[t.jsx(st,{asChild:!0,children:t.jsxs("div",{className:"relative cursor-pointer group",children:[t.jsxs(Te,{className:"w-24 h-24 ring-4 ring-primary/20 shadow-lg",children:[t.jsx(Fe,{src:fe||""}),t.jsx(Me,{className:"bg-gradient-to-br from-primary via-primary/80 to-primary/50 text-white text-3xl font-bold",children:(($=l[0])==null?void 0:$.toUpperCase())||"U"})]}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx(Le,{className:"h-6 w-6 text-white"})})]})}),t.jsxs(ce,{className:"sm:max-w-md",children:[t.jsx(de,{children:t.jsx(ue,{children:"Change Profile Picture"})}),t.jsx("div",{className:"flex flex-col gap-4 py-4",children:t.jsx("input",{type:"file",accept:"image/*",onChange:ge,className:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90 file:cursor-pointer"})})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Username"}),t.jsx(w,{value:d,onChange:f=>m(f.target.value),placeholder:"Enter your username",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Display Name"}),t.jsx(w,{value:l,onChange:f=>u(f.target.value),placeholder:"Enter your display name",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bio"}),t.jsx(Pe,{value:n,onChange:f=>c(f.target.value),placeholder:"Tell us about yourself",className:"min-h-[100px] rounded-2xl glass border-border/50 resize-none focus:border-primary transition-apple"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),t.jsx(w,{value:x,onChange:f=>F(f.target.value),placeholder:"Enter your location",className:"h-12 rounded-2xl glass border-border/50 focus:border-primary transition-apple"})]}),t.jsx(U,{onClick:me,disabled:k,className:"w-full h-12 rounded-2xl bg-primary hover:bg-primary/90 font-semibold transition-apple",children:k?"Saving...":"Save Changes"})]})})]}),t.jsx(we,{})]})};export{yt as default};
